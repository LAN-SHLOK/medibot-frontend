<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>MediBot AI - Equalizer</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
  
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="chat.css">

  <style>
    /* üü¢ SCI-FI AR MESH (CSS Only) */
    .ar-mesh {
        background-image: 
            linear-gradient(rgba(6, 182, 212, 0.2) 1px, transparent 1px),
            linear-gradient(90deg, rgba(6, 182, 212, 0.2) 1px, transparent 1px);
        background-size: 40px 40px;
        perspective: 1000px;
        transform: rotateX(10deg);
        box-shadow: inset 0 0 100px rgba(6, 182, 212, 0.3);
    }
    .ar-reticle {
        position: absolute;
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        width: 200px; height: 200px;
        border: 2px solid rgba(6, 182, 212, 0.6);
        border-radius: 10px;
    }
    .ar-reticle::before, .ar-reticle::after {
        content: ''; position: absolute; width: 20px; height: 20px;
        border-color: #06b6d4; border-style: solid;
    }
    .ar-reticle::before { top: -2px; left: -2px; border-width: 4px 0 0 4px; }
    .ar-reticle::after { bottom: -2px; right: -2px; border-width: 0 4px 4px 0; }

    /* üü¢ HIDE SCROLLBAR UTILITY */
    .no-scrollbar::-webkit-scrollbar {
        display: none;
    }
    .no-scrollbar {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }
    /* üü¢ EMERGENCY SOS OVERRIDE */
    /* üü¢ EMERGENCY SOS OVERRIDE (Persistent Red Tint) */
    .emergency-override {
        background-color: rgba(40, 5, 5, 0.9) !important; /* Dark slightly red background */
        animation: critical-alert 2s infinite alternate !important;
        transition: background-color 0.5s ease;
    }
    @keyframes critical-alert {
        from { box-shadow: inset 0 0 20px rgba(239, 68, 68, 0.1); }
        to { box-shadow: inset 0 0 100px rgba(239, 68, 68, 0.3); }
    }
  </style>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { 
            cyber: { primary: '#2563eb', secondary: '#db2777', cyan: '#06b6d4', dark: '#020617' } 
          },
          fontFamily: { orbitron: ['Orbitron', 'sans-serif'], rajdhani: ['Rajdhani', 'sans-serif'] },
          animation: {
            'float-subtle': 'floatSubtle 5s ease-in-out infinite',
            'blink': 'blink 4s infinite',
            'scan-bar': 'scanBar 2s ease-in-out infinite',
            'cradle-left': 'cradleLeft 1s infinite ease-in-out',
            'cradle-right': 'cradleRight 1s infinite ease-in-out',
            'hat-pulse': 'hatPulse 2s infinite alternate',
            'happy-bounce': 'happyBounce 0.6s ease-in-out infinite',
            'bar-bounce': 'barBounce 0.5s ease-in-out infinite',
          },
          keyframes: {
            floatSubtle: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-6px)' } },
            blink: { '0%, 48%, 52%, 100%': { transform: 'scaleY(1)' }, '50%': { transform: 'scaleY(0.1)' } },
            scanBar: { '0%': { width: '0%', left: '0', opacity: '0' }, '50%': { width: '100%', left: '0', opacity: '1' }, '100%': { width: '0%', right: '0', opacity: '0', left: 'auto' } },
            cradleLeft: { '0%, 100%': { transform: 'translateX(0)' }, '25%': { transform: 'translateX(-10px)' }, '50%': { transform: 'translateX(0)' } },
            cradleRight: { '0%, 100%': { transform: 'translateX(0)' }, '50%': { transform: 'translateX(0)' }, '75%': { transform: 'translateX(10px)' } },
            hatPulse: { '0%': { filter: 'drop-shadow(0 0 2px #06b6d4)' }, '100%': { filter: 'drop-shadow(0 0 8px #06b6d4)' } },
            happyBounce: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-8px)' } },
            barBounce: { '0%, 100%': { transform: 'scaleY(0.4)' }, '50%': { transform: 'scaleY(1.2)' } }
          }
        }
      }
    }
  </script>
</head>

<body class="bg-cyber-dark text-slate-200 font-rajdhani h-screen w-screen flex flex-col overflow-hidden selection:bg-pink-500 selection:text-white">

  <canvas id="warpCanvas" class="fixed inset-0 z-0 opacity-40 pointer-events-none"></canvas>
  <div class="cyber-grid-3d"></div>
  <div class="vignette"></div>

    <div class="fixed top-0 left-0 w-full p-3 md:p-4 z-50 flex items-center justify-between pointer-events-none">
      <button onclick="toggleSidebar()" class="pointer-events-auto w-10 h-10 flex items-center justify-center rounded-lg glass-panel text-slate-400 hover:text-cyan-400 hover:border-cyan-400 hover:shadow-[0_0_15px_rgba(6,182,212,0.5)] transition-all duration-300">
          <i class="fas fa-bars"></i>
      </button>

      <div class="flex items-center gap-4 pointer-events-auto">
          <div class="hidden md:flex items-center gap-2 px-3 py-1.5 bg-black/50 border border-emerald-500/30 rounded-full shadow-[0_0_10px_rgba(16,185,129,0.2)] backdrop-blur-sm">
              <div class="w-1.5 h-1.5 rounded-full bg-emerald-400 animate-pulse"></div>
              <span class="text-[9px] text-emerald-400 font-orbitron tracking-widest">UPLINK <span id="pingValue" class="text-slate-300 ml-1">24ms</span></span>
          </div>

          <div class="relative group">
              <button onclick="toggleProfile()" id="profileBtn" class="w-10 h-10 p-[1px] rounded-full border border-white/10 bg-black/60 hover:border-pink-500 hover:shadow-[0_0_15px_rgba(219,39,119,0.5)] transition-all duration-300">
                  <img id="userAvatar" referrerpolicy="no-referrer" src="https://cdn-icons-png.flaticon.com/512/847/847969.png" class="w-full h-full object-cover rounded-full opacity-80 group-hover:opacity-100" alt="Profile" />
              </button>
              
              <div id="profileDropdown" class="hidden absolute right-0 mt-3 w-56 glass-panel rounded-xl overflow-hidden z-50 animate-fade-in-up border-t border-blue-500/50">
                  <div class="px-4 py-3 border-b border-white/5 bg-gradient-to-r from-blue-600/10 to-transparent">
                    <p class="text-[10px] text-cyan-400 font-orbitron tracking-widest">AUTHORIZED USER</p>
                    <p id="dropdownUserName" class="text-sm font-bold text-white truncate mt-1">Loading...</p>
                  </div>
                  <button onclick="logout()" class="w-full text-left px-4 py-3 text-sm text-red-400 hover:bg-white/5 transition-colors flex items-center gap-2">
                      <i class="fas fa-power-off"></i> Disconnect
                  </button>
              </div>
          </div>
      </div>
  </div>
  <div id="sidebarOverlay" onclick="toggleSidebar()" class="fixed inset-0 z-40 bg-black/90 backdrop-blur-sm hidden transition-opacity duration-300"></div>
  <div id="sidebar" class="fixed top-0 left-0 h-full w-72 glass-panel border-r border-white/10 z-50 transform -translate-x-full transition-transform duration-300 ease-out flex flex-col bg-[#020617]/95">
    <div class="p-6 border-b border-white/10 flex items-center justify-between">
      <span class="text-xl font-bold font-orbitron text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-cyan-400 tracking-wider">MEDIBOT</span>
      <button onclick="toggleSidebar()" class="text-slate-500 hover:text-white"><i class="fas fa-times"></i></button>
    </div>
    <div class="flex-1 overflow-y-auto py-4 px-4 space-y-2 no-scrollbar">
      <button onclick="window.location.reload()" class="w-full text-left px-4 py-3 rounded-lg border border-pink-500/20 bg-pink-500/10 text-pink-400 hover:bg-pink-500 hover:text-white hover:shadow-[0_0_15px_rgba(219,39,119,0.4)] flex items-center gap-3 transition-all font-orbitron text-xs tracking-wide">
        <i class="fas fa-plus"></i> NEW SCAN
      </button>
      <div class="text-[10px] text-slate-500 font-bold tracking-widest font-orbitron mt-6 mb-2 px-2">HISTORY</div>
      <div id="historyList" class="space-y-2"></div>
    </div>
  </div>

  <div id="cameraModal" class="hidden fixed inset-0 z-[60] bg-black/95 backdrop-blur-md flex flex-col items-center justify-center p-4 animate-fade-in">
      <div class="relative w-full max-w-2xl bg-[#0f0f16] rounded-2xl overflow-hidden border border-cyan-500/30 shadow-[0_0_50px_rgba(6,182,212,0.2)]">
          <video id="videoFeed" autoplay playsinline class="w-full h-[60vh] object-cover transform scale-x-[-1]"></video>
          <div id="arOverlay" class="absolute inset-0 pointer-events-none opacity-60 ar-mesh"></div>
          <div class="absolute inset-0 pointer-events-none flex items-center justify-center">
              <div class="ar-reticle animate-pulse"></div>
          </div>
          <div class="absolute inset-0 pointer-events-none">
              <div class="absolute top-4 left-1/2 -translate-x-1/2 bg-black/60 px-4 py-1 rounded-full border border-cyan-500/30 text-cyan-400 text-xs font-orbitron tracking-widest animate-pulse">‚óè LIVE BIOMETRIC SCAN</div>
              <div class="absolute top-4 left-4 w-8 h-8 border-t-2 border-l-2 border-cyan-500"></div>
              <div class="absolute top-4 right-4 w-8 h-8 border-t-2 border-r-2 border-cyan-500"></div>
              <div class="absolute bottom-4 left-4 w-8 h-8 border-b-2 border-l-2 border-cyan-500"></div>
              <div class="absolute bottom-4 right-4 w-8 h-8 border-b-2 border-r-2 border-cyan-500"></div>
          </div>
          <div class="absolute bottom-8 w-full flex justify-center items-center gap-8 z-20">
              <button onclick="closeCamera()" class="w-12 h-12 rounded-full bg-slate-800/80 text-white hover:bg-red-500/80 transition-all border border-white/10 flex items-center justify-center"><i class="fas fa-times text-lg"></i></button>
              <button onclick="capturePhoto()" class="w-20 h-20 rounded-full border-4 border-white/20 flex items-center justify-center hover:scale-105 active:scale-95 transition-all group">
                  <div class="w-16 h-16 bg-white rounded-full group-hover:bg-cyan-400 transition-colors shadow-[0_0_20px_rgba(255,255,255,0.5)]"></div>
              </button>
              <button class="w-12 h-12 rounded-full bg-slate-800/80 text-white/50 cursor-not-allowed border border-white/10 flex items-center justify-center"><i class="fas fa-bolt"></i></button> 
          </div>
      </div>
  </div>
  <div class="hidden xl:flex flex-col fixed left-4 top-24 bottom-24 w-60 z-10 pointer-events-none">
      <div class="text-[10px] text-slate-500 font-orbitron tracking-widest mb-4 flex items-center gap-2">
          <span class="w-4 h-[1px] bg-slate-700"></span>
          SESSION TIMELINE
      </div>
      
      <div class="glass-panel p-4 rounded-xl border border-white/5 bg-black/40 backdrop-blur-md shadow-2xl flex-1 overflow-hidden flex flex-col pointer-events-auto">
          <div id="sessionTimeline" class="flex-1 overflow-y-auto no-scrollbar space-y-4 relative pl-2 border-l border-slate-700/50 ml-2 mt-2 pb-4 font-rajdhani">
              <div class="relative">
                  <div class="absolute -left-[13px] top-1.5 w-2 h-2 rounded-full bg-emerald-400 shadow-[0_0_8px_#34d399]"></div>
                  <div class="text-[11px] text-emerald-400 font-bold tracking-wide">SYSTEM INITIALIZED</div>
                  <div class="text-[9px] text-slate-500 mt-0.5">Awaiting input...</div>
              </div>
          </div>
      </div>
  </div>

  <div class="hidden xl:flex flex-col fixed right-4 top-24 bottom-24 w-64 z-10 pointer-events-none">
      <div class="text-[10px] text-slate-500 font-orbitron tracking-widest mb-4 flex items-center justify-end gap-2">
          LIVE CLINICAL NOTES
          <span class="w-4 h-[1px] bg-slate-700"></span>
      </div>
      
      <div class="glass-panel p-4 rounded-xl border border-white/10 bg-black/40 backdrop-blur-md shadow-2xl pointer-events-auto flex flex-col">
          <div class="flex justify-between items-center border-b border-white/5 pb-2 mb-3">
              <span class="text-[9px] text-slate-400 font-orbitron tracking-widest">CASE ID:</span>
              <span class="text-[11px] text-cyan-400 font-orbitron font-bold" id="caseIdDisplay">#MB-001</span>
          </div>

          <div class="space-y-4">
              <div>
                  <div class="text-[9px] text-slate-500 font-orbitron tracking-widest mb-2">DETECTED ENTITIES</div>
                  <div id="clinicalTags" class="flex flex-wrap gap-1.5">
                      <span class="text-[9px] text-slate-600 italic font-rajdhani">No data extracted yet...</span>
                  </div>
              </div>

              <div class="pt-2 border-t border-white/5">
                  <div class="text-[9px] text-slate-500 font-orbitron tracking-widest mb-1">CURRENT PHASE</div>
                  <div id="clinicalPhase" class="text-[11px] text-pink-500 font-bold font-rajdhani animate-pulse">Consultation</div>
              </div>
          </div>
      </div>
  </div>
  <div class="relative z-10 w-full max-w-4xl h-screen mx-auto flex flex-col items-center p-2">
    
    <div id="welcomeText" class="relative w-full flex flex-col items-center justify-center pt-4 shrink-0 z-20 pointer-events-none select-none transition-all duration-500">
      <div id="botContainer" class="relative w-[140px] h-[140px] md:w-[160px] md:h-[160px] flex items-center justify-center animate-float-subtle transition-transform duration-300">
        <div class="absolute inset-0 bg-blue-600/10 rounded-full blur-[60px] animate-pulse-slow"></div>
        <div id="successRing" class="absolute inset-0 border-2 border-green-500 rounded-full opacity-0"></div>
        <svg id="doctorBot" viewBox="0 0 200 200" class="w-full h-full overflow-visible drop-shadow-[0_0_30px_rgba(37,99,235,0.4)]">
          <defs><filter id="glow" x="-50%" y="-50%" width="200%" height="200%"><feGaussianBlur stdDeviation="3" result="coloredBlur"/><feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs>
          <g id="hatGroup" class="origin-center"><rect x="55" y="10" width="90" height="36" rx="8" class="fill-[#020617] stroke-cyan-400" stroke-width="3" /><g id="hatCross"><line x1="100" y1="20" x2="100" y2="36" class="stroke-pink-500" stroke-width="3" stroke-linecap="round"/><line x1="92" y1="28" x2="108" y2="28" class="stroke-pink-500" stroke-width="3" stroke-linecap="round"/></g></g>
          <g id="topDots" class="opacity-0 transition-opacity duration-300"><circle class="fill-cyan-400" cx="80" cy="-5" r="3" id="topDotLeft" /><circle class="fill-cyan-400" cx="100" cy="-5" r="3" /><circle class="fill-cyan-400" cx="120" cy="-5" r="3" id="topDotRight" /></g>
          <rect x="25" y="45" width="150" height="130" rx="28" class="fill-[#020617] stroke-cyan-400" stroke-width="3" filter="url(#glow)"/>
          <g class="animate-blink origin-center" id="eyesContainer"><ellipse id="eyeLeft" cx="70" cy="100" rx="13" ry="17" class="fill-pink-500 transition-all duration-300" /><circle id="pupilLeft" cx="70" cy="100" r="5" class="fill-white pupil transition-all duration-300" /><ellipse id="eyeRight" cx="130" cy="100" rx="13" ry="17" class="fill-pink-500 transition-all duration-300" /><circle id="pupilRight" cx="130" cy="100" r="5" class="fill-white pupil transition-all duration-300" /></g>
          <g transform="translate(100, 140)"><path id="mouthLine" d="M-20 0 L20 0" class="stroke-cyan-400 transition-all duration-300" stroke-width="3" fill="none" stroke-linecap="round"/><g id="voiceBars" class="opacity-0 transition-opacity duration-200"><rect x="-20" y="-5" width="5" height="10" rx="2" class="fill-cyan-400 animate-bar-1" style="transform-box: fill-box; transform-origin: bottom;" /><rect x="-10" y="-8" width="5" height="16" rx="2" class="fill-pink-500 animate-bar-2" style="transform-box: fill-box; transform-origin: bottom;" /><rect x="0" y="-12" width="5" height="24" rx="2" class="fill-cyan-400 animate-bar-3" style="transform-box: fill-box; transform-origin: bottom;" /><rect x="10" y="-8" width="5" height="16" rx="2" class="fill-pink-500 animate-bar-2" style="transform-box: fill-box; transform-origin: bottom;" /><rect x="20" y="-5" width="5" height="10" rx="2" class="fill-cyan-400 animate-bar-1" style="transform-box: fill-box; transform-origin: bottom;" /></g></g>
          <g id="mouthDots" class="opacity-0 transition-opacity duration-300"><circle class="fill-pink-500" cx="85"  cy="142" r="4" style="transform-origin: 100px 142px;" id="dotLeft"/><circle class="fill-pink-500" cx="100" cy="142" r="4" /><circle class="fill-pink-500" cx="115" cy="142" r="4" style="transform-origin: 100px 142px;" id="dotRight"/></g>
        </svg>
      </div>
      <div class="flex items-center gap-2 mt-4 px-5 py-1.5 glass-panel rounded-full border border-white/5 transition-all shadow-lg" id="statusBadge">
        <span id="statusDot" class="w-2 h-2 rounded-full bg-slate-500"></span>
        <span id="statusText" class="text-[10px] font-orbitron font-bold tracking-widest text-slate-400">READY</span>
      </div>
    </div>

    <div id="thinkingWrapper" class="hidden w-full max-w-2xl mx-auto mb-4 animate-fade-in-up shrink-0 z-40">
        <div class="glass-panel border-white/10 bg-black/60 rounded-xl overflow-hidden shadow-[0_0_20px_rgba(6,182,212,0.1)]">
            <div onclick="toggleThinking()" class="w-full flex items-center justify-between p-3 cursor-pointer hover:bg-white/5 transition-colors group">
                <div class="flex items-center gap-3">
                    <div class="thinking-loader"></div>
                    <span id="thinkingStatusText" class="text-[10px] font-orbitron tracking-widest text-cyan-400 uppercase">Consulting specialist nexus...</span>
                </div>
                <i id="thinkingArrow" class="fas fa-chevron-down text-slate-500 group-hover:text-cyan-400 transition-transform duration-300"></i>
            </div>
            <div id="agentDiscussion" class="hidden p-4 border-t border-white/5 bg-black/40 space-y-4 max-h-60 overflow-y-auto no-scrollbar">
                </div>
        </div>
    </div>

   <div class="flex-1 w-full min-h-0 flex flex-col justify-end px-4 pb-2">
        <div id="messages" class="w-full overflow-y-auto pr-2 flex flex-col gap-3 pt-2 no-scrollbar">
            
            <div id="emptyStateGuides" class="w-full flex flex-col items-center justify-center mt-12 mb-8 animate-fade-in-up">
              <div id="bootTerminal" class="w-full flex flex-col items-center justify-center mb-6 space-y-1 min-h-[60px]"></div>

                <div class="w-full max-w-2xl flex items-center justify-center gap-3 mb-6 mt-2 px-4">
                    <div class="flex-1 h-[1px] bg-gradient-to-r from-transparent to-slate-700"></div>
                    <span class="text-[10px] text-slate-500 font-orbitron tracking-widest whitespace-nowrap">SYSTEM CAPABILITIES & ARCHITECTURE</span>
                    <div class="flex-1 h-[1px] bg-gradient-to-l from-transparent to-slate-700"></div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-2xl px-4">
                    <button onclick="showFeatureDetails('triage')" class="glass-panel p-4 rounded-xl border border-cyan-500/20 hover:border-cyan-400 hover:bg-cyan-500/5 transition-all text-left group">
                        <div class="flex justify-between items-start">
                            <i class="fas fa-network-wired text-cyan-400 mb-2 text-lg group-hover:scale-110 transition-transform"></i>
                            <i class="fas fa-info-circle text-cyan-500/50 text-xs"></i>
                        </div>
                        <h4 class="font-orbitron text-[11px] text-slate-200 font-bold tracking-wide">MULTI-AGENT TRIAGE</h4>
                        <p class="text-[11px] text-slate-500 font-rajdhani mt-1">Info on Neural Network Routing & Agent Council.</p>
                    </button>
                    
                    <button onclick="showFeatureDetails('vision')" class="glass-panel p-4 rounded-xl border border-pink-500/20 hover:border-pink-500 hover:bg-pink-500/5 transition-all text-left group">
                        <div class="flex justify-between items-start">
                            <i class="fas fa-brain text-pink-500 mb-2 text-lg group-hover:scale-110 transition-transform"></i>
                            <i class="fas fa-info-circle text-pink-500/50 text-xs"></i>
                        </div>
                        <h4 class="font-orbitron text-[11px] text-slate-200 font-bold tracking-wide">CNN VISION SCANNER</h4>
                        <p class="text-[11px] text-slate-500 font-rajdhani mt-1">Info on X-Ray & MRI deep learning models.</p>
                    </button>

                    <button onclick="showFeatureDetails('voice')" class="glass-panel p-4 rounded-xl border border-emerald-500/20 hover:border-emerald-500 hover:bg-emerald-500/5 transition-all text-left group">
                        <div class="flex justify-between items-start">
                            <i class="fas fa-microchip text-emerald-400 mb-2 text-lg group-hover:scale-110 transition-transform"></i>
                            <i class="fas fa-info-circle text-emerald-500/50 text-xs"></i>
                        </div>
                        <h4 class="font-orbitron text-[11px] text-slate-200 font-bold tracking-wide">WHISPER GPU ENGINE</h4>
                        <p class="text-[11px] text-slate-500 font-rajdhani mt-1">Info on hands-free continuous voice processing.</p>
                    </button>

                    <button onclick="showFeatureDetails('camera')" class="glass-panel p-4 rounded-xl border border-purple-500/20 hover:border-purple-500 hover:bg-purple-500/5 transition-all text-left group">
                        <div class="flex justify-between items-start">
                            <i class="fas fa-camera text-purple-400 mb-2 text-lg group-hover:scale-110 transition-transform"></i>
                            <i class="fas fa-info-circle text-purple-500/50 text-xs"></i>
                        </div>
                        <h4 class="font-orbitron text-[11px] text-slate-200 font-bold tracking-wide">OPENCV LIVE SCANNER</h4>
                        <p class="text-[11px] text-slate-500 font-rajdhani mt-1">Info on real-time biometric and injury analysis.</p>
                    </button>
                </div>
            </div>
            
        </div>
    </div>

    <div class="w-full shrink-0 px-2 pb-6 z-30">
      <div id="filePreview" class="hidden mb-2 w-full flex justify-start pl-2 animate-fade-in-up">
        <div class="gradient-border p-[1px] shadow-[0_0_25px_rgba(37,99,235,0.4)] w-48">
            <div class="relative w-full h-24 md:h-32 bg-[#020617] rounded-xl overflow-hidden flex flex-col items-center justify-center group">
                <div class="absolute inset-0 bg-scan-grid opacity-20 animate-grid-scroll"></div>
                <div id="previewContent" class="w-full h-full flex items-center justify-center bg-black/20 p-3 z-10 relative"></div>
                <div id="scanBar" class="absolute bottom-0 left-0 h-1 bg-cyan-400 shadow-[0_0_15px_#06b6d4] z-20"></div>
                <div class="absolute top-2 left-2 bg-black/70 px-2 py-0.5 rounded text-[8px] text-cyan-400 font-orbitron tracking-wide border border-cyan-500/20 backdrop-blur-sm z-20">SCANNING</div>
                <div class="absolute bottom-2 w-full text-center z-20">
                     <span id="previewFileName" class="text-[9px] text-white/90 font-rajdhani font-bold truncate max-w-[120px] block mx-auto tracking-wide bg-black/50 rounded px-1">file.jpg</span>
                </div>
                <button onclick="clearFile()" class="absolute top-1 right-1 w-6 h-6 flex items-center justify-center text-slate-400 hover:text-red-400 z-30 transition-colors bg-black/50 rounded hover:bg-black/80"><i class="fas fa-times text-xs"></i></button>
            </div>
        </div>
      </div>

      <div class="relative w-full glass-panel rounded-xl p-2 shadow-2xl flex items-center gap-2 transition-all border border-white/5 hover:border-blue-500/40 focus-within:border-blue-500/60 focus-within:shadow-[0_0_20px_rgba(37,99,235,0.3)]">
        <input type="file" id="fileInput" class="hidden" onchange="handleFileSelect(this)" />
        <input type="file" id="cameraInput" accept="image/*" capture="environment" class="hidden" onchange="handleFileSelect(this)" />
        <button onclick="document.getElementById('fileInput').click()" class="w-10 h-10 shrink-0 rounded-lg flex items-center justify-center text-slate-400 hover:text-cyan-400 hover:bg-cyan-400/10 transition-all"><i class="fas fa-paperclip"></i></button>
        <input id="chatInput" oninput="resetVoiceMode()" class="flex-1 min-w-0 bg-transparent text-[15px] text-white placeholder-slate-500 px-2 py-2 outline-none font-rajdhani font-medium tracking-wide" placeholder="Enter symptoms or upload scan..." onkeypress="if(event.key === 'Enter') sendMessage()" />
        <button onclick="startCamera()" class="w-10 h-10 shrink-0 rounded-lg flex items-center justify-center text-slate-400 hover:text-cyan-400 hover:bg-cyan-400/10 transition-all">
            <i class="fas fa-camera"></i>
        </button>
        <button id="micBtn" onclick="toggleListening()" class="w-10 h-10 shrink-0 rounded-lg flex items-center justify-center text-slate-400 hover:text-pink-500 hover:bg-pink-500/10 transition-all"><i class="fas fa-microphone"></i></button>
        <button id="analyzeBtn" onclick="sendMessage()" class="relative overflow-hidden h-10 px-4 md:px-6 rounded-lg bg-gradient-to-r from-blue-600 to-pink-600 text-white text-xs font-bold font-orbitron tracking-wider shadow-lg hover:scale-105 active:scale-95 transition-all group shrink-0">
            <span class="relative z-10">
                <span class="hidden md:inline">ANALYZE</span>
                <span class="inline md:hidden"><i class="fas fa-bolt text-sm"></i></span>
            </span>
            <div class="absolute inset-0 -translate-x-full group-hover:animate-shine bg-gradient-to-r from-transparent via-white/30 to-transparent z-0"></div>
        </button>

        <button id="stopBtn" onclick="stopGeneration()" class="hidden h-10 px-4 md:px-6 rounded-lg bg-red-600/20 border border-red-500/50 text-red-500 hover:bg-red-600 hover:text-white text-xs font-bold font-orbitron tracking-wider shadow-[0_0_15px_rgba(239,68,68,0.3)] transition-all shrink-0 animate-pulse">
            <i class="fas fa-stop hidden md:inline mr-2"></i>
            <span class="hidden md:inline">STOP</span>
            <span class="inline md:hidden"><i class="fas fa-stop text-sm"></i></span>
        </button>
      </div>
    </div>
  </div>

  <script src="config.js"></script> <script src="api.js"></script> <script src="chat.js"></script> 
</body>
</html>
